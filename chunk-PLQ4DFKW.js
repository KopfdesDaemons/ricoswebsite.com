import{b as p}from"./chunk-HDYNTN7V.js";import{a as l,c,d as L,t as d}from"./chunk-YF5PBYPB.js";import{V as o,_ as s,f as r,ja as i,na as u,xa as h}from"./chunk-SRQQ6BZJ.js";var T=(()=>{let e=class e{constructor(){this.router=s(d),this.translate=s(p),this.location=s(l),this.platformId=s(h),this.document=s(i),this.userLanguage=u(""),this.askUserToSwitch=!0,this.supportedLanguages=["de","en"],this.oldLanguage="",this.translate.addLangs(this.supportedLanguages),this.translate.setDefaultLang("en"),this.userAgendLanguage=this.getUserAgentLanguage(),this.userLanguage.set(this.userAgendLanguage),this.loadLanguageFromLocalStorage()}loadLanguageFromLocalStorage(){if(!c(this.platformId))return;let t=localStorage.getItem("Custom Language");t&&(this.userLanguage.set(t),this.askUserToSwitch=!1)}updateLanguage(t){return r(this,null,function*(){t=t||this.userLanguage(),this.userLanguage.set(yield this.replaceUnsupportedLangauge(t)),this.document.documentElement.lang=this.userLanguage(),this.askUserToSwitch=this.askUserToSwitch&&this.userLanguage()!=this.userAgendLanguage,this.translate.use(this.userLanguage())})}replaceUnsupportedLangauge(t){return r(this,null,function*(){if(!this.supportedLanguages.includes(t)){let a=this.userAgendLanguage,g=this.router.url.replace(t,a);return console.log(`Language ${t} not supported. Switching to ${a}`),yield this.router.navigateByUrl(g),a}return t})}switchUserLanguage(t){return r(this,null,function*(){this.oldLanguage=this.userLanguage(),this.userLanguage.set(t);let a=this.location.path().replace(this.oldLanguage,t);console.log(`Switching language from ${this.oldLanguage} to ${t}. New URL: ${a}`),this.location.path().includes(this.oldLanguage)||(yield this.updateLanguage(t)),yield this.router.navigateByUrl(a),localStorage.setItem("Custom Language",this.userLanguage().toString()),this.askUserToSwitch=!1})}getUserAgentLanguage(){if(L(this.platformId))return"en";let t=navigator.language||navigator.languages&&navigator.languages[0];return console.log(`Detected user language: ${t}`),t?t.split("-")[0]:"en"}};e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();export{T as a};
