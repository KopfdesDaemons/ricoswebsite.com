import{b as l}from"./chunk-XCEHSNQX.js";import{b as g,c as i,e as u,f as h,v as c}from"./chunk-I2XG3XIQ.js";import{U as n,_ as a,f as r,ya as o}from"./chunk-I6EKFGAG.js";var v=(()=>{class s{constructor(){this.router=a(c),this.translate=a(l),this.location=a(i),this.platformId=a(o),this.document=a(g),this.userLanguage="en",this.askUserToSwitch=!1,this.supportedLanguages=["de","en"],this.oldLanguage="",this.translate.addLangs(this.supportedLanguages),this.translate.setDefaultLang("en"),this.loadLanguageFromLocalStorage(),this.userAgendLanguage=this.getLanguageFromUserAgent()}loadLanguageFromLocalStorage(){if(!u(this.platformId))return;this.askUserToSwitch=!0;let e=localStorage.getItem("Custom Language");e&&(this.userLanguage=e,this.askUserToSwitch=!1)}updateLanguage(e){return r(this,null,function*(){e||(e=this.userAgendLanguage),this.userLanguage=yield this.replaceUnsupportedLangauge(e),this.document.documentElement.lang=this.userLanguage;let t=this.askUserToSwitch&&this.userLanguage!=this.userAgendLanguage;this.askUserToSwitch=t,this.translate.use(this.userLanguage)})}replaceUnsupportedLangauge(e){return r(this,null,function*(){if(!this.supportedLanguages.includes(e)){let t=this.userAgendLanguage,L=this.router.url.replace(e,t);return console.log("Language "+e+" not supported. Switching to "+t),yield this.router.navigateByUrl(L),t}return e})}switchUserLanguage(e){return r(this,null,function*(){this.oldLanguage=this.userLanguage,this.userLanguage=e;let t=this.location.path().replace(this.oldLanguage,e);console.log("Switching language from "+this.oldLanguage+" to "+e+" newURL: "+t),yield this.router.navigateByUrl(t),localStorage.setItem("Custom Language",this.userLanguage.toString()),this.askUserToSwitch=!1})}getLanguageFromUserAgent(){if(h(this.platformId))return"en";let e=navigator.language||navigator.languages&&navigator.languages[0];return console.log(`Detected user language: ${e}`),e?e.split("-")[0]:"en"}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{v as a};
