import{a as f}from"./chunk-74B255KG.js";import{b as p}from"./chunk-LGVXDRNZ.js";import{p as d}from"./chunk-DB6AOJU4.js";import{e as L,k as g,l as m}from"./chunk-NCU52XL5.js";import{U as i,Z as s,ac as c,bc as l,ia as u,ma as o,wa as h}from"./chunk-P6XYFBVA.js";var b=(()=>{let a=class a{constructor(){this.router=s(d),this.translate=s(p),this.location=s(L),this.platformId=s(h),this.document=s(u),this.consentS=s(f),this.customLanguageConsent=c(()=>this.consentS.possibleConsents.find(e=>e.name==="Custom Language Consent")?.consent()??!1),this.userLanguage=o(""),this.askUserToSwitch=o(!0),this.supportedLanguages=["de","en"],this.oldLanguage="",this.translate.addLangs(this.supportedLanguages),this.translate.setDefaultLang("en"),this.userAgendLanguage=this.getUserAgentLanguage(),this.userLanguage.set(this.userAgendLanguage),this.loadLanguageFromLocalStorage(),l(()=>{if(!this.customLanguageConsent()){if(!g(this.platformId))return;localStorage.removeItem("Custom Language")}})}loadLanguageFromLocalStorage(){if(!g(this.platformId))return;let e=localStorage.getItem("Custom Language");e&&(this.userLanguage.set(e),this.askUserToSwitch.set(!1))}async updateLanguage(e){e=e||this.userLanguage(),this.userLanguage.set(await this.replaceUnsupportedLangauge(e)),this.document.documentElement.lang=this.userLanguage(),this.askUserToSwitch.set(this.askUserToSwitch()&&this.userLanguage()!=this.userAgendLanguage),this.translate.use(this.userLanguage())}async replaceUnsupportedLangauge(e){if(!this.supportedLanguages.includes(e)){let t=this.userAgendLanguage,r=this.router.url.replace(e,t);return console.log(`Language ${e} not supported. Switching to ${t}`),await this.router.navigateByUrl(r),t}return e}async switchUserLanguage(e){this.oldLanguage=this.userLanguage(),this.userLanguage.set(e);let t=this.location.path().replace(this.oldLanguage,e);console.log(`Switching language from ${this.oldLanguage} to ${e}. New URL: ${t}`),this.location.path().includes(this.oldLanguage)||await this.updateLanguage(e),await this.router.navigateByUrl(t),localStorage.setItem("Custom Language",this.userLanguage().toString()),this.askUserToSwitch.set(!1),this.consentS.giveConsent("Custom Language Consent")}getUserAgentLanguage(){if(m(this.platformId))return"en";let e=navigator.language||navigator.languages&&navigator.languages[0];return console.log(`Detected user language: ${e}`),e?e.split("-")[0]:"en"}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=i({token:a,factory:a.\u0275fac,providedIn:"root"});let n=a;return n})();export{b as a};
