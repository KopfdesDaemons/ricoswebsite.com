import{b as d}from"./chunk-GYUCNXMX.js";import{a as u,b as h,d as c,e as l,u as L}from"./chunk-K6Z3VPJB.js";import{U as g,_ as e,f as r,ua as i,ya as o}from"./chunk-BAJSPIZF.js";var I=(()=>{class s{constructor(){this.router=e(L),this.translate=e(d),this.location=e(h),this.platformId=e(o),this.document=e(u),this.userLanguage=i(""),this.askUserToSwitch=!0,this.supportedLanguages=["de","en"],this.oldLanguage="",this.translate.addLangs(this.supportedLanguages),this.translate.setDefaultLang("en"),this.userAgendLanguage=this.getUserAgentLanguage(),this.userLanguage.set(this.userAgendLanguage),this.loadLanguageFromLocalStorage()}loadLanguageFromLocalStorage(){if(!c(this.platformId))return;let t=localStorage.getItem("Custom Language");t&&(this.userLanguage.set(t),this.askUserToSwitch=!1)}updateLanguage(t){return r(this,null,function*(){t=t||this.userLanguage(),this.userLanguage.set(yield this.replaceUnsupportedLangauge(t)),this.document.documentElement.lang=this.userLanguage(),this.askUserToSwitch=this.askUserToSwitch&&this.userLanguage()!=this.userAgendLanguage,this.translate.use(this.userLanguage())})}replaceUnsupportedLangauge(t){return r(this,null,function*(){if(!this.supportedLanguages.includes(t)){let a=this.userAgendLanguage,n=this.router.url.replace(t,a);return console.log(`Language ${t} not supported. Switching to ${a}`),yield this.router.navigateByUrl(n),a}return t})}switchUserLanguage(t){return r(this,null,function*(){this.oldLanguage=this.userLanguage(),this.userLanguage.set(t);let a=this.location.path().replace(this.oldLanguage,t);console.log(`Switching language from ${this.oldLanguage} to ${t}. New URL: ${a}`),this.location.path().includes(this.oldLanguage)||(yield this.updateLanguage(t)),yield this.router.navigateByUrl(a),localStorage.setItem("Custom Language",this.userLanguage().toString()),this.askUserToSwitch=!1})}getUserAgentLanguage(){if(l(this.platformId))return"en";let t=navigator.language||navigator.languages&&navigator.languages[0];return console.log(`Detected user language: ${t}`),t?t.split("-")[0]:"en"}static{this.\u0275fac=function(a){return new(a||s)}}static{this.\u0275prov=g({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{I as a};
