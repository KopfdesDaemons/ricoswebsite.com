import{b as d}from"./chunk-TF5TYL7V.js";import{a as h,c as l,d as c,t as L}from"./chunk-5HCMFROV.js";import{O as g,T as s,ca as o,ga as i,qa as u}from"./chunk-C7F2T4HE.js";var I=(()=>{let e=class e{constructor(){this.router=s(L),this.translate=s(d),this.location=s(h),this.platformId=s(u),this.document=s(o),this.userLanguage=i(""),this.askUserToSwitch=!0,this.supportedLanguages=["de","en"],this.oldLanguage="",this.translate.addLangs(this.supportedLanguages),this.translate.setDefaultLang("en"),this.userAgendLanguage=this.getUserAgentLanguage(),this.userLanguage.set(this.userAgendLanguage),this.loadLanguageFromLocalStorage()}loadLanguageFromLocalStorage(){if(!l(this.platformId))return;let t=localStorage.getItem("Custom Language");t&&(this.userLanguage.set(t),this.askUserToSwitch=!1)}async updateLanguage(t){t=t||this.userLanguage(),this.userLanguage.set(await this.replaceUnsupportedLangauge(t)),this.document.documentElement.lang=this.userLanguage(),this.askUserToSwitch=this.askUserToSwitch&&this.userLanguage()!=this.userAgendLanguage,this.translate.use(this.userLanguage())}async replaceUnsupportedLangauge(t){if(!this.supportedLanguages.includes(t)){let a=this.userAgendLanguage,n=this.router.url.replace(t,a);return console.log(`Language ${t} not supported. Switching to ${a}`),await this.router.navigateByUrl(n),a}return t}async switchUserLanguage(t){this.oldLanguage=this.userLanguage(),this.userLanguage.set(t);let a=this.location.path().replace(this.oldLanguage,t);console.log(`Switching language from ${this.oldLanguage} to ${t}. New URL: ${a}`),this.location.path().includes(this.oldLanguage)||await this.updateLanguage(t),await this.router.navigateByUrl(a),localStorage.setItem("Custom Language",this.userLanguage().toString()),this.askUserToSwitch=!1}getUserAgentLanguage(){if(c(this.platformId))return"en";let t=navigator.language||navigator.languages&&navigator.languages[0];return console.log(`Detected user language: ${t}`),t?t.split("-")[0]:"en"}};e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();export{I as a};
